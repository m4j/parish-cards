\documentclass[12pt, letterpaper, oneside]{article}
\usepackage[%hmargin={0.3in,0.3in},
            %vmargin={0.49in,0.9in},
            margin=1in,
            %showframe,
            %headheight=1.2in,
            %headsep=15pt,
            verbose]{geometry}
\usepackage[russian,english]{babel}
\usepackage[useregional]{datetime2}
\usepackage{multicol}
\usepackage{longtable}
\usepackage{booktabs}
\usepackage{fontspec}
\setmainfont{Liberation Sans}

\title{Помянники и просфоры\\{\large Commemoration books and prosphoras}}
\date{\vspace{-2\baselineskip}\today\\{\small \selectlanguage{english}\today}}

% Disable hyphenation, see https://tex.stackexchange.com/a/177179
\tolerance=1
\emergencystretch=\maxdimen
\hyphenpenalty=10000
\hbadness=10000

\raggedbottom

\setlength{\parskip}{1.5ex} % 1ex plus 0.5ex minus 0.2ex}
\setlength{\parindent}{0pt}

\usepackage{sectsty}
\allsectionsfont{\centering}
% no section numbering
\setcounter{secnumdepth}{0}

\usepackage{tocloft}
\renewcommand{\cftsecleader}{\cftdotfill{\cftsecdotsep}}
\renewcommand\cftsecdotsep{\cftdot}
%\renewcommand\cfttoctitlefont{\huge}

%\newcommand{\endornament}{\vspace{1cm}
%\hfil  \pgfornament[width=4cm]{84}\hfil}

\begin{document}

\selectlanguage{russian}
\renewcommand{\contentsname}{}

\maketitle

\tableofcontents

\input{prosphoranotes.tex}

\pagebreak

\section{Воскресная английская литургия\\Sunday English Liturgy}

\bigskip

\begin{multicols}{2}

\BLOCK{for row in data}
    \BLOCK{set quantity = row["quantity"]}
    \BLOCK{set liturgy = row["liturgy"]}
    \BLOCK{set comment = row["comment"]}
    \BLOCK{if liturgy.strip().lower() == "english"}

        \BLOCK{set enSurname = row["en\_last\_name"]}
        \BLOCK{set enName = row["en\_first\_name"]}
        \BLOCK{if enSurname.strip()}
            \BLOCK{set enSurname = enSurname.upper()}
        \BLOCK{else}
            \BLOCK{set enSurname = enName.upper()}
            \BLOCK{set enName = ""}
        \BLOCK{endif}
        \BLOCK{set ruSurname = row["ru\_last\_name"]}
        \BLOCK{set ruName = row["ru\_first\_name"]}
        \BLOCK{if ruSurname.strip()}
            \BLOCK{set ruSurname = ruSurname.upper()}
        \BLOCK{else}
            \BLOCK{set ruSurname = ruName.upper()}
            \BLOCK{set ruName = ""}
        \BLOCK{endif}

        \parbox{0.4\textwidth}{
            \textbf{\VAR{enSurname}} {\small \VAR{enName}}\\
            \textbf{\VAR{ruSurname}} {\small \VAR{ruName}}
        }
        \framebox{{\large\bfseries \VAR{quantity}}}
    \BLOCK{endif}
\BLOCK{endfor}

\end{multicols}

\pagebreak

\section{Воскресная славянская литургия\\Sunday Slavonic Liturgy}

\begin{multicols}{2}

\BLOCK{for row in data}
    \BLOCK{set quantity = row["quantity"]}
    \BLOCK{set liturgy = row["liturgy"]}
    \BLOCK{set comment = row["comment"]}
    \BLOCK{if liturgy.strip().lower() != "english"}

        \BLOCK{set enSurname = row["en\_last\_name"]}
        \BLOCK{set enName = row["en\_first\_name"]}
        \BLOCK{if enSurname.strip()}
            \BLOCK{set enSurname = enSurname.upper()}
        \BLOCK{else}
            \BLOCK{set enSurname = enName.upper()}
            \BLOCK{set enName = ""}
        \BLOCK{endif}
        \BLOCK{set ruSurname = row["ru\_last\_name"]}
        \BLOCK{set ruName = row["ru\_first\_name"]}
        \BLOCK{if ruSurname.strip()}
            \BLOCK{set ruSurname = ruSurname.upper()}
        \BLOCK{else}
            \BLOCK{set ruSurname = ruName.upper()}
            \BLOCK{set ruName = ""}
        \BLOCK{endif}

        \parbox{0.4\textwidth}{
            \textbf{\VAR{enSurname}} {\small \VAR{enName}}\\
            \textbf{\VAR{ruSurname}} {\small \VAR{ruName}}
        }
        \framebox{{\large\bfseries \VAR{quantity}}}
    \BLOCK{endif}
\BLOCK{endfor}

\end{multicols}

\pagebreak

\section{Литургия по двунадесятым праздникам\\12 Great Feasts Liturgy}

\bigskip

\begin{multicols}{2}

\BLOCK{for row in data}
    \BLOCK{set quantity = row["quantity"]}
    \BLOCK{set liturgy = row["liturgy"]}
    \BLOCK{set comment = row["comment"]}
    \BLOCK{if comment.strip().lower() == "+12 feasts" or liturgy.strip().lower() == "every"}

        \BLOCK{set enSurname = row["en\_last\_name"]}
        \BLOCK{set enName = row["en\_first\_name"]}
        \BLOCK{if enSurname.strip()}
            \BLOCK{set enSurname = enSurname.upper()}
        \BLOCK{else}
            \BLOCK{set enSurname = enName.upper()}
            \BLOCK{set enName = ""}
        \BLOCK{endif}
        \BLOCK{set ruSurname = row["ru\_last\_name"]}
        \BLOCK{set ruName = row["ru\_first\_name"]}
        \BLOCK{if ruSurname.strip()}
            \BLOCK{set ruSurname = ruSurname.upper()}
        \BLOCK{else}
            \BLOCK{set ruSurname = ruName.upper()}
            \BLOCK{set ruName = ""}
        \BLOCK{endif}

        \parbox{0.4\textwidth}{
            \textbf{\VAR{enSurname}} {\small \VAR{enName}}\\
            \textbf{\VAR{ruSurname}} {\small \VAR{ruName}}
        }
        \framebox{{\large\bfseries \VAR{quantity}}}
    \BLOCK{endif}
\BLOCK{endfor}

\end{multicols}

\pagebreak

\section{Единая литургия на английском и славянском\\One Liturgy in English and Slavonic}

\bigskip

\begin{multicols}{2}

\BLOCK{for row in data}
    \BLOCK{set quantity = row["quantity"]}
    \BLOCK{set enSurname = row["en\_last\_name"]}
    \BLOCK{set enName = row["en\_first\_name"]}
    \BLOCK{if enSurname.strip()}
        \BLOCK{set enSurname = enSurname.upper()}
    \BLOCK{else}
        \BLOCK{set enSurname = enName.upper()}
        \BLOCK{set enName = ""}
    \BLOCK{endif}
    \BLOCK{set ruSurname = row["ru\_last\_name"]}
    \BLOCK{set ruName = row["ru\_first\_name"]}
    \BLOCK{if ruSurname.strip()}
        \BLOCK{set ruSurname = ruSurname.upper()}
    \BLOCK{else}
        \BLOCK{set ruSurname = ruName.upper()}
        \BLOCK{set ruName = ""}
    \BLOCK{endif}

    \parbox{0.4\textwidth}{
        \textbf{\VAR{enSurname}} {\small \VAR{enName}}\\
        \textbf{\VAR{ruSurname}} {\small \VAR{ruName}}
    }
    \framebox{{\large\bfseries \VAR{quantity}}}

\BLOCK{endfor}
\end{multicols}

\end{document}

